{"version":3,"sources":["../src/components/menu/menuItem.tsx"],"names":[],"mappings":"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","file":"components/menu/menuItem.js","sourcesContent":["/*\n * Copyright 2015 Palantir Technologies, Inc. All rights reserved.\n * Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy\n * of the license at https://github.com/palantir/blueprint/blob/master/LICENSE\n * and https://github.com/palantir/blueprint/blob/master/PATENTS\n */\n\nimport * as classNames from \"classnames\";\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { AbstractComponent } from \"../../common/abstractComponent\";\nimport * as Classes from \"../../common/classes\";\nimport * as Errors from \"../../common/errors\";\nimport { Position } from \"../../common/position\";\nimport { IActionProps, ILinkProps } from \"../../common/props\";\nimport { Popover, PopoverInteractionKind } from \"../popover/popover\";\nimport { Menu } from \"./menu\";\n\nexport interface IMenuItemProps extends IActionProps, ILinkProps {\n    // override from IActionProps to make it required\n    /** Item text, required for usability. */\n    text: string;\n\n    /**\n     * Right-aligned label content, useful for hotkeys.\n     */\n    label?: string | JSX.Element;\n\n    /**\n     * Whether an enabled, non-submenu item should automatically close the\n     * popover it is nested within when clicked.\n     * @default true\n     */\n    shouldDismissPopover?: boolean;\n\n    /**\n     * Array of props objects for submenu items.\n     * An alternative to providing `MenuItem` components as `children`.\n     */\n    submenu?: IMenuItemProps[];\n\n    /**\n     * Width of \"margin\" from left or right edge of viewport. Submenus will\n     * flip to the other side if they come within this distance of that edge.\n     * This has no effect if omitted or if `useSmartPositioning={false}`.\n     * Note that these values are not CSS properties; they are used in\n     * internal math to determine when to flip sides.\n     */\n    submenuViewportMargin?: { left?: number, right?: number };\n\n    /**\n     * Whether a submenu popover will try to reposition itself\n     * if there isn't room for it in its current position.\n     * The popover opens right by default, but will try to flip\n     * left if not enough space.\n     * @default true\n     */\n    useSmartPositioning?: boolean;\n}\n\nexport interface IMenuItemState {\n    /** Whether a submenu is opened to the left */\n    alignLeft?: boolean;\n}\n\nconst REACT_CONTEXT_TYPES = { alignLeft: React.PropTypes.bool };\n\nexport class MenuItem extends AbstractComponent<IMenuItemProps, IMenuItemState> {\n    public static defaultProps: IMenuItemProps = {\n        disabled: false,\n        shouldDismissPopover: true,\n        submenuViewportMargin: {},\n        text: \"\",\n        useSmartPositioning: true,\n    };\n    public static displayName = \"Blueprint.MenuItem\";\n\n    public static contextTypes: React.ValidationMap<IMenuItemState> = REACT_CONTEXT_TYPES;\n    public static childContextTypes: React.ValidationMap<IMenuItemState> = REACT_CONTEXT_TYPES;\n    public context: IMenuItemState;\n\n    public state: IMenuItemState = {\n        alignLeft: false,\n    };\n\n    private liElement: HTMLElement;\n\n    public render() {\n        const { children, disabled, label, submenu } = this.props;\n        const hasSubmenu = children != null || submenu != null;\n        const liClasses = classNames({\n            [Classes.MENU_SUBMENU]: hasSubmenu,\n        });\n        const anchorClasses = classNames(Classes.MENU_ITEM, Classes.intentClass(this.props.intent), {\n            [Classes.DISABLED]: disabled,\n            // prevent popover from closing when clicking on submenu trigger or disabled item\n            [Classes.POPOVER_DISMISS]: this.props.shouldDismissPopover && !disabled && !hasSubmenu,\n        }, Classes.iconClass(this.props.iconName), this.props.className);\n\n        let labelElement: JSX.Element;\n        if (label != null) {\n            labelElement = <span className=\"pt-menu-item-label\">{label}</span>;\n        }\n\n        let content = (\n            <a\n                className={anchorClasses}\n                href={disabled ? undefined : this.props.href}\n                onClick={disabled ? undefined : this.props.onClick}\n                tabIndex={disabled ? undefined : 0}\n                target={this.props.target}\n            >\n                {labelElement}\n                {this.props.text}\n            </a>\n        );\n\n        if (hasSubmenu) {\n            const measureSubmenu = (this.props.useSmartPositioning) ? this.measureSubmenu : null;\n            const submenuElement = <Menu ref={measureSubmenu}>{this.renderChildren()}</Menu>;\n            const popoverClasses = classNames({\n                [Classes.ALIGN_LEFT]: this.state.alignLeft,\n            });\n\n            content = (\n                <Popover\n                    content={submenuElement}\n                    isDisabled={disabled}\n                    enforceFocus={false}\n                    hoverCloseDelay={0}\n                    inline={true}\n                    interactionKind={PopoverInteractionKind.HOVER}\n                    position={this.state.alignLeft ? Position.LEFT_TOP : Position.RIGHT_TOP}\n                    popoverClassName={classNames(Classes.MINIMAL, Classes.MENU_SUBMENU, popoverClasses)}\n                    useSmartArrowPositioning={false}\n                >\n                    {content}\n                </Popover>\n            );\n        }\n\n        return (\n            <li\n                className={liClasses}\n                ref={this.liRefHandler}\n            >\n                {content}\n            </li>\n        );\n    }\n\n    public getChildContext() {\n        return { alignLeft: this.state.alignLeft };\n    }\n\n    protected validateProps(props: IMenuItemProps & {children?: React.ReactNode}) {\n        if (props.children != null && props.submenu != null) {\n            throw new Error(Errors.MENU_CHILDREN_SUBMENU_MUTEX);\n        }\n    }\n\n    private liRefHandler = (r: HTMLElement) => this.liElement = r;\n\n    private measureSubmenu = (el: Menu) => {\n        if (el != null) {\n            const submenuRect = ReactDOM.findDOMNode(el).getBoundingClientRect();\n            const parentWidth = this.liElement.parentElement.getBoundingClientRect().width;\n            const adjustmentWidth = submenuRect.width + parentWidth;\n\n            // this ensures that the left and right measurements represent a submenu opened to the right\n            let submenuLeft = submenuRect.left;\n            let submenuRight = submenuRect.right;\n            if (this.state.alignLeft) {\n                submenuLeft += adjustmentWidth;\n                submenuRight += adjustmentWidth;\n            }\n\n            let { left = 0, right = 0 } = this.props.submenuViewportMargin;\n            if (typeof document !== \"undefined\"\n                && typeof document.documentElement !== \"undefined\"\n                && Number(document.documentElement.clientWidth)) {\n                // we're in a browser context and the clientWidth is available,\n                // use it to set calculate 'right'\n                right = document.documentElement.clientWidth - right;\n            }\n            // uses context to prioritize the previous positioning\n            let alignLeft = this.context.alignLeft || false;\n            if (alignLeft) {\n                if ((submenuLeft - adjustmentWidth) <= left) {\n                    alignLeft = false;\n                }\n            } else {\n                if (submenuRight >= right) {\n                    alignLeft = true;\n                }\n            }\n            this.setState({ alignLeft });\n        }\n    }\n\n    private renderChildren = () => {\n        let { children, submenu } = this.props;\n\n        if (children != null) {\n            const childProps = this.cascadeProps();\n            if (Object.keys(childProps).length !== 0) {\n                children = React.Children.map(children, (child: JSX.Element) => {\n                    return React.cloneElement(child, childProps);\n                });\n            }\n        } else if (submenu != null) {\n            children = submenu.map(this.cascadeProps).map(renderMenuItem);\n        }\n\n        return children;\n    }\n\n    /**\n     * Evalutes this.props and cascades prop values into new props when:\n     * - submenuViewportMargin is defined, but is undefined for the supplied input.\n     * - useSmartPositioning is false, but is undefined for the supplied input.\n     * @param {IMenuItemProps} newProps If supplied, object will be modified, otherwise, defaults to an empty object.\n     * @returns An object to be used as child props.\n     */\n    private cascadeProps = (newProps: IMenuItemProps = {} as IMenuItemProps) => {\n        const { submenuViewportMargin, useSmartPositioning } = this.props;\n\n        if (submenuViewportMargin != null && newProps.submenuViewportMargin == null) {\n            newProps.submenuViewportMargin = submenuViewportMargin;\n        }\n        if (useSmartPositioning === false && newProps.useSmartPositioning == null) {\n            newProps.useSmartPositioning = useSmartPositioning;\n        }\n\n        return newProps;\n    }\n}\n\nexport function renderMenuItem(props: IMenuItemProps, key: string | number) {\n    return <MenuItem key={key} {...props} />;\n}\n\nexport const MenuItemFactory = React.createFactory(MenuItem);\n"]}